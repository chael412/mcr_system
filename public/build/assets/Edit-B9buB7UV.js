import{r as n,u as E,j as a,H as L,L as R,a as x}from"./app-iuPb_p0T.js";import{F as d}from"./FormField-Bm8sCl_F.js";import"./select-BoTjmzGQ.js";import{L as h}from"./label-Cg_ebJp5.js";import{A as w}from"./AuthenticatedLayout-hjy_bosG.js";import{B as v}from"./button-D8ZVTOSn.js";import{I as D}from"./input-BPXi7sWs.js";import"./dialog-D15BfkAM.js";import{S as y}from"./react-select.esm-CMsDnCaX.js";import{u as I}from"./useAppUrl-CRgjXwUN.js";import"./index-CyClVJfQ.js";const J=({member:i})=>{var f;const b=I(),j=i.id,[F,N]=n.useState([]),[m,c]=n.useState(((f=i.register.family_head_id)==null?void 0:f.toString())||""),[C,_]=n.useState(""),{data:r,setData:s,errors:l,processing:S}=E({firstname:i.firstname,middlename:i.middlename,lastname:i.lastname,sex:i.sex,date_birth:i.date_birth,order_birth:i.order_birth,place_birth:i.place_birth,father_name:i.father_name,mother_name:i.mother_name,relationship_to_familyhead:i.relationship_to_familyhead,remarks:i.remarks,register_number:i.register.register_number,family_head_id:m,date_of_registration:i.register.date_of_registration,date_place_marriage:i.sex,birth_certificate:""}),M=async()=>{try{const e=await x.get(`${b}/api/familyhead_options`);N(e.data)}catch(e){console.error("Error fetching authors:",e),alert("Failed to fetch authors.")}};n.useEffect(()=>{M()},[]),n.useEffect(()=>{_(i.sex||""),s("sex",i.sex||"")},[i.sex]),n.useEffect(()=>{var e;if((e=i.register)!=null&&e.family_head_id){const t=i.register.family_head_id.toString();c(t),s("family_head_id",t)}},[i]);const g=F.map(e=>({value:e.id.toString(),label:e.lastname+", "+e.firstname+" "+(e.middlename||"")})),p=[{value:"M",label:"Male"},{value:"F",label:"Female"}],k=e=>{s("birth_certificate",e.target.files[0])},H=async e=>{var u;e.preventDefault();const t=new FormData;t.append("firstname",r.firstname),t.append("middlename",r.middlename),t.append("lastname",r.lastname),t.append("sex",r.sex),t.append("date_birth",r.date_birth),t.append("order_birth",r.order_birth),t.append("place_birth",r.place_birth),t.append("father_name",r.father_name),t.append("mother_name",r.mother_name),t.append("relationship_to_familyhead",r.relationship_to_familyhead),t.append("remarks",r.remarks),t.append("register_number",r.register_number),t.append("family_head_id",parseInt(r.family_head_id,10)),t.append("date_of_registration",r.date_of_registration),t.append("date_place_marriage",r.date_place_marriage),t.append("birth_certificate",r.birth_certificate);try{const o=await await x.post(`http://localhost:8000/api/update_familymember/${j}`,t,{headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"multipart/form-data","X-HTTP-Method-Override":"PUT"}});(o.status===200||o.status===201)&&(alert("Family member updated successfully!"),window.location.reload())}catch(o){console.error("Error saving family member:",((u=o.response)==null?void 0:u.data)||o),alert("Failed to update family member.")}};return console.log("member prop:",i),a.jsxs(w,{header:a.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Family Member"}),children:[a.jsx(L,{title:"Family Members"}),a.jsx("div",{className:" flex justify-center mb-5",children:a.jsx("div",{className:"border border-gray-400 w-[620px] rounded-md ",children:a.jsxs("form",{onSubmit:H,className:"px-6 py-4 space-y-4",children:[a.jsx("h2",{className:"text-2xl",children:"Edit Family Member"}),a.jsx("hr",{}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("div",{className:"flex items-center gap-6 mb-2",children:a.jsx(h,{htmlFor:"family_head",children:"Family Head"})}),a.jsx("input",{type:"hidden",value:m,onChange:e=>s("family_head_id",e.target.value)}),a.jsx(y,{value:g.find(e=>e.value===m),options:g,onChange:e=>{const t=(e==null?void 0:e.value)||"";c(t),s("family_head_id",t)}})]}),a.jsxs("div",{children:[a.jsx(h,{htmlFor:"birth_certificate",children:"Birth Certificate"}),a.jsx(D,{type:"file",onChange:k})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsx(d,{id:"regsistry_number",label:"Registry Number",value:r.register_number,onChange:e=>s("register_number",e.target.value),error:l.register_number}),a.jsx(d,{id:"date_of_registration",label:"Date of Registration",type:"date",value:r.date_of_registration,onChange:e=>s("date_of_registration",e.target.value),error:l.date_of_registration})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsx(d,{id:"firstname",label:"FirstName",value:r.firstname,onChange:e=>s("firstname",e.target.value),error:l.firstname}),a.jsx(d,{id:"middlename",label:"MiddleName",value:r.middlename,onChange:e=>s("middlename",e.target.value),error:l.middlename})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsx(d,{id:"lastname",label:"LastName",value:r.lastname,onChange:e=>s("lastname",e.target.value),error:l.lastname}),a.jsxs("div",{children:[a.jsx(h,{htmlFor:"sex",children:"Sex"}),a.jsx(y,{value:p.find(e=>e.value===C),options:p,onChange:e=>{const t=(e==null?void 0:e.value)||"";_(t),s("sex",t)}})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsx(d,{id:"order_birth",label:"Order of Birth",value:r.order_birth,onChange:e=>s("order_birth",e.target.value),error:l.order_birth}),a.jsx(d,{id:"date_birth",label:"Date of Birth",type:"date",value:r.date_birth,onChange:e=>s("date_birth",e.target.value),error:l.date_birth})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 ",children:a.jsx(d,{id:"place_birth",label:"Place of Birth",value:r.place_birth,onChange:e=>s("place_birth",e.target.value),error:l.place_birth})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsx(d,{id:"father_name",label:"Name of Father",value:r.father_name,onChange:e=>s("father_name",e.target.value),error:l.father_name}),a.jsx(d,{id:"mother_name",label:"Name of Mother",value:r.mother_name,onChange:e=>s("mother_name",e.target.value),error:l.mother_name})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 ",children:a.jsx(d,{id:"date_place_marriage",label:"Date & Place of Marriage",value:r.date_place_marriage,onChange:e=>s("date_place_marriage",e.target.value),error:l.date_place_marriage})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsx(d,{id:"relationship_to_familyhead",label:"Relationship to Family Head",value:r.relationship_to_familyhead,onChange:e=>s("relationship_to_familyhead",e.target.value),error:l.relationship_to_familyhead}),a.jsx(d,{id:"remarks",label:"Remarks",value:r.remarks,onChange:e=>s("remarks",e.target.value),error:l.remarks})]}),a.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200",children:[a.jsx(R,{href:"/family_members",children:a.jsx(v,{type:"button",variant:"outline",children:"Cancel"})}),a.jsx(v,{type:"submit",disabled:S,className:"px-6 py-2",children:"Update"})]})]})})})]})};export{J as default};
